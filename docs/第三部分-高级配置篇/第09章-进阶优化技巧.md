# ç¬¬9ç«  è¿›é˜¶ä¼˜åŒ–æŠ€å·§

åœ¨æŒæ¡äº†åŸºæœ¬é…ç½®åï¼Œæœ¬ç« å°†ä»‹ç»å„ç§è¿›é˜¶ä¼˜åŒ–æŠ€å·§ï¼Œå¸®åŠ©ä½ è·å¾—æ›´å¿«ã€æ›´ç¨³å®šçš„ç§‘å­¦ä¸Šç½‘ä½“éªŒã€‚

## 9.1 TCPä¼˜åŒ–ï¼ˆBBRç­‰ï¼‰

### 9.1.1 TCPæ‹¥å¡æ§åˆ¶ç®—æ³•

**ä»€ä¹ˆæ˜¯æ‹¥å¡æ§åˆ¶ï¼Ÿ**

TCPæ‹¥å¡æ§åˆ¶ç®—æ³•å†³å®šäº†æ•°æ®ä¼ è¾“çš„é€Ÿåº¦å’Œæ•ˆç‡ã€‚

```
ç½‘ç»œæ‹¥å µæ—¶ï¼š
ä¼ ç»Ÿç®—æ³• â†’ å¤§å¹…é™é€Ÿ â†’ æ¢å¤æ…¢
BBRç®—æ³• â†’ æ™ºèƒ½è°ƒèŠ‚ â†’ ä¿æŒé«˜é€Ÿ
```

**å¸¸è§ç®—æ³•å¯¹æ¯”ï¼š**

| ç®—æ³• | å¹´ä»£ | ç‰¹ç‚¹ | æ€§èƒ½ |
|-----|------|------|------|
| **Reno** | 1990 | ç»å…¸ç®—æ³• | â­â­ |
| **CUBIC** | 2005 | Linuxé»˜è®¤ | â­â­â­ |
| **BBR** | 2016 | Googleå¼€å‘ | â­â­â­â­â­ |
| **BBRv2** | 2020 | BBRæ”¹è¿›ç‰ˆ | â­â­â­â­â­ |

### 9.1.2 BBRç®—æ³•åŸç†

**BBR (Bottleneck Bandwidth and RTT)ï¼š**

```
ä¼ ç»Ÿç®—æ³•ï¼š
ä¸¢åŒ… â†’ è®¤ä¸ºæ‹¥å µ â†’ é™é€Ÿ
      (å¯èƒ½è¯¯åˆ¤ï¼Œå¦‚WiFiå¹²æ‰°å¯¼è‡´çš„ä¸¢åŒ…)

BBRç®—æ³•ï¼š
æŒç»­æ¢æµ‹ï¼š
  â”œâ”€ æµ‹é‡ç“¶é¢ˆå¸¦å®½
  â”œâ”€ æµ‹é‡å¾€è¿”æ—¶å»¶
  â””â”€ æ™ºèƒ½è°ƒèŠ‚å‘é€é€Ÿç‡

ä¼˜åŠ¿ï¼š
âœ“ é«˜ä¸¢åŒ…ç¯å¢ƒä»ä¿æŒé«˜é€Ÿ
âœ“ è·¨å›½é•¿è·ç¦»è¿æ¥æå‡æ˜æ˜¾
âœ“ å……åˆ†åˆ©ç”¨å¸¦å®½
```

**æ€§èƒ½æå‡ï¼š**

```
å…¸å‹åœºæ™¯ï¼šå›½å†…â†’ç¾å›½VPS

CUBICç®—æ³•ï¼š
ä¸‹è½½é€Ÿåº¦ï¼š~5 MB/s
å»¶è¿Ÿï¼š200ms
ä¸¢åŒ…ç‡ï¼š1%

BBRç®—æ³•ï¼š
ä¸‹è½½é€Ÿåº¦ï¼š~15-20 MB/sï¼ˆæå‡3-4å€ï¼‰
å»¶è¿Ÿï¼š180ms
ä¸¢åŒ…ç‡ï¼š1%ï¼ˆç›¸åŒæ¡ä»¶ï¼‰

æ³¨ï¼šå®é™…æå‡å–å†³äºç½‘ç»œç¯å¢ƒ
```

### 9.1.3 å¼€å¯BBRï¼ˆLinuxæœåŠ¡å™¨ï¼‰

**æ£€æŸ¥å½“å‰ç®—æ³•ï¼š**

```bash
# æŸ¥çœ‹å¯ç”¨ç®—æ³•
sysctl net.ipv4.tcp_available_congestion_control

# æŸ¥çœ‹å½“å‰ä½¿ç”¨ç®—æ³•
sysctl net.ipv4.tcp_congestion_control

# æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ï¼ˆBBRéœ€è¦4.9+ï¼‰
uname -r
```

**å¯ç”¨BBRï¼š**

```bash
# æ–¹æ³•1ï¼šä¸´æ—¶å¯ç”¨ï¼ˆé‡å¯å¤±æ•ˆï¼‰
sudo sysctl -w net.core.default_qdisc=fq
sudo sysctl -w net.ipv4.tcp_congestion_control=bbr

# æ–¹æ³•2ï¼šæ°¸ä¹…å¯ç”¨
# ç¼–è¾‘sysctlé…ç½®
sudo nano /etc/sysctl.conf

# æ·»åŠ ä»¥ä¸‹å†…å®¹
net.core.default_qdisc=fq
net.ipv4.tcp_congestion_control=bbr

# ä¿å­˜ååº”ç”¨
sudo sysctl -p

# éªŒè¯
sysctl net.ipv4.tcp_congestion_control
# è¾“å‡ºï¼šnet.ipv4.tcp_congestion_control = bbr

lsmod | grep bbr
# å¦‚æœæ˜¾ç¤ºtcp_bbrï¼Œè¯´æ˜BBRå·²åŠ è½½
```

**ä¸€é”®è„šæœ¬ï¼š**

```bash
# ç§‹æ°´é€¸å†°BBRä¸€é”®è„šæœ¬
wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh
chmod +x bbr.sh
./bbr.sh

# è„šæœ¬ä¼šï¼š
# 1. æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬
# 2. å‡çº§å†…æ ¸ï¼ˆå¦‚éœ€è¦ï¼‰
# 3. å¯ç”¨BBR
# 4. é‡å¯ç³»ç»Ÿ

# é‡å¯åéªŒè¯
uname -r                                  # æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬
sysctl net.ipv4.tcp_congestion_control   # æŸ¥çœ‹BBRçŠ¶æ€
```

### 9.1.4 BBR Plus / BBR2 / é”é€Ÿ

**BBR Plusï¼ˆé­”æ”¹BBRï¼‰ï¼š**

```bash
# ç‰¹ç‚¹ï¼š
âœ“ åŸºäºBBRæ”¹è¿›
âœ“ æ›´æ¿€è¿›çš„ç­–ç•¥
âœ“ æŸäº›åœºæ™¯é€Ÿåº¦æ›´å¿«
âš ï¸ å¯èƒ½å¢åŠ ä¸¢åŒ…

# å®‰è£…ï¼ˆéœ€è°¨æ…ï¼‰
wget "https://github.com/chiakge/Linux-NetSpeed/raw/master/tcp.sh"
chmod +x tcp.sh
./tcp.sh

# é€‰æ‹©ï¼šå®‰è£… BBR Plus
```

**BBRv2ï¼ˆå®˜æ–¹æ”¹è¿›ç‰ˆï¼‰ï¼š**

```bash
# éœ€è¦Linux 5.10+å†…æ ¸
# Debian 11/Ubuntu 20.04+é»˜è®¤æ”¯æŒ

# å¯ç”¨BBRv2
sudo sysctl -w net.ipv4.tcp_congestion_control=bbr2
echo "net.ipv4.tcp_congestion_control=bbr2" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
```

**BBRv3ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰ï¼š**

```bash
# ç‰¹ç‚¹ï¼š
âœ“ è¿›ä¸€æ­¥æ”¹è¿›å…¬å¹³æ€§
âœ“ ä¼˜åŒ–æ‹¥å¡æ§åˆ¶ç®—æ³•
âœ“ æ›´å¥½çš„å¤šæµæ€§èƒ½
âœ“ å‡å°‘ç¼“å†²åŒºè†¨èƒ€

# éœ€è¦Linux 5.18+å†…æ ¸
# Debian 12/Ubuntu 22.04+æ”¯æŒ

# æ£€æŸ¥æ˜¯å¦æ”¯æŒ
sysctl net.ipv4.tcp_available_congestion_control

# å¯ç”¨BBRv3ï¼ˆå¦‚æœæ”¯æŒï¼‰
sudo sysctl -w net.ipv4.tcp_congestion_control=bbr
echo "net.ipv4.tcp_congestion_control=bbr" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p

# æ³¨æ„ï¼šè¾ƒæ–°å†…æ ¸ä¸­çš„bbrå¯èƒ½å·²æ˜¯v3ç‰ˆæœ¬
# æŸ¥çœ‹å®é™…ç‰ˆæœ¬éœ€æ£€æŸ¥å†…æ ¸æºç 
```

**ç‰ˆæœ¬é€‰æ‹©å»ºè®®ï¼š**

```
æ¨èæ–¹æ¡ˆï¼š
â€¢ ç”Ÿäº§ç¯å¢ƒï¼šBBR v1ï¼ˆæœ€ç¨³å®šï¼Œ5.4+å†…æ ¸ï¼‰
â€¢ è¿½æ±‚æ€§èƒ½ï¼šBBRv2/v3ï¼ˆéœ€è¾ƒæ–°å†…æ ¸ï¼‰
â€¢ ä¸ç¡®å®šæ—¶ï¼šä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„BBRç‰ˆæœ¬

é¿å…ï¼š
â€¢ BBR Plusç­‰ç¬¬ä¸‰æ–¹é­”æ”¹ç‰ˆï¼ˆå¯èƒ½ä¸ç¨³å®šï¼‰
â€¢ é¢‘ç¹åˆ‡æ¢ç‰ˆæœ¬ï¼ˆå½±å“è¿æ¥ç¨³å®šæ€§ï¼‰
```

**é”é€Ÿï¼ˆLotServerï¼‰ï¼š**

```
ç‰¹ç‚¹ï¼š
âœ“ å•†ä¸šåŠ é€Ÿè½¯ä»¶
âœ“ å•è¾¹åŠ é€Ÿï¼ˆä»…æœåŠ¡å™¨ç«¯ï¼‰
âœ“ å¯¹ä¸¢åŒ…ç¯å¢ƒä¼˜åŒ–å¥½
âš ï¸ é—­æºï¼Œæœ‰é£é™©
âš ï¸ éƒ¨åˆ†å†…æ ¸ä¸å…¼å®¹

ä¸æ¨èä½¿ç”¨ï¼ˆBBRå·²è¶³å¤Ÿï¼‰
```

### 9.1.5 å®¢æˆ·ç«¯TCPä¼˜åŒ–

**Windowsä¼˜åŒ–ï¼š**

```powershell
# ä»¥ç®¡ç†å‘˜è¿è¡ŒPowerShell

# 1. å¯ç”¨TCPçª—å£è‡ªåŠ¨è°ƒèŠ‚
netsh interface tcp set global autotuninglevel=normal

# 2. å¯ç”¨ç›´æ¥ç¼“å­˜è®¿é—®
netsh interface tcp set global dca=enabled

# 3. å¯ç”¨æ¥æ”¶ç«¯åˆå¹¶
netsh interface tcp set global rsc=enabled

# 4. æŸ¥çœ‹å½“å‰è®¾ç½®
netsh interface tcp show global
```

**macOSä¼˜åŒ–ï¼š**

```bash
# å¢å¤§æ¥æ”¶ç¼“å†²åŒº
sudo sysctl -w net.inet.tcp.recvspace=65536
sudo sysctl -w net.inet.tcp.sendspace=65536

# å¯ç”¨TCPçª—å£ç¼©æ”¾
sudo sysctl -w net.inet.tcp.rfc1323=1
```

**Linuxä¼˜åŒ–ï¼š**

```bash
# ç¼–è¾‘ /etc/sysctl.conf
sudo nano /etc/sysctl.conf

# æ·»åŠ ä»¥ä¸‹ä¼˜åŒ–å‚æ•°
# TCPä¼˜åŒ–
net.ipv4.tcp_fastopen=3
net.ipv4.tcp_slow_start_after_idle=0
net.ipv4.tcp_no_metrics_save=1

# ç¼“å†²åŒºä¼˜åŒ–
net.core.rmem_max=67108864
net.core.wmem_max=67108864
net.core.netdev_max_backlog=250000
net.core.somaxconn=4096
net.ipv4.tcp_rmem=4096 87380 67108864
net.ipv4.tcp_wmem=4096 65536 67108864
net.ipv4.tcp_mem=67108864 67108864 67108864

# åº”ç”¨è®¾ç½®
sudo sysctl -p
```

## 9.2 UDPåŠ é€Ÿé…ç½®

### 9.2.1 ä¸ºä»€ä¹ˆéœ€è¦UDP

**UDPçš„é‡è¦æ€§ï¼š**

```
TCPåè®®ï¼š
âœ“ å¯é ä¼ è¾“
âœ“ é¡ºåºä¿è¯
âœ— å»¶è¿Ÿé«˜
âœ— æ•ˆç‡ä½

UDPåè®®ï¼š
âœ“ ä½å»¶è¿Ÿ
âœ“ æ•ˆç‡é«˜
âœ— ä¸ä¿è¯é€è¾¾
âœ— æ— åºä¼ è¾“

é€‚ç”¨åœºæ™¯ï¼š
UDPå¿…éœ€ï¼š
- è§†é¢‘é€šè¯ï¼ˆZoomã€Teamsï¼‰
- åœ¨çº¿æ¸¸æˆ
- è¯­éŸ³é€šè¯
- ç›´æ’­æ¨æµ

TCPå³å¯ï¼š
- ç½‘é¡µæµè§ˆ
- æ–‡ä»¶ä¸‹è½½
- é‚®ä»¶æ”¶å‘
```

### 9.2.2 ä»£ç†åè®®UDPæ”¯æŒ

**Shadowsocks UDPï¼š**

```json
{
  "server": "your-server.com",
  "server_port": 8388,
  "password": "your-password",
  "method": "chacha20-ietf-poly1305",
  "mode": "tcp_and_udp",    # å…³é”®ï¼šåŒæ—¶æ”¯æŒTCPå’ŒUDP
  "fast_open": true
}
```

**V2Ray UDPï¼š**

```json
{
  "inbounds": [{
    "port": 1080,
    "protocol": "socks",
    "settings": {
      "udp": true    # å¯ç”¨UDP
    }
  }],
  "outbounds": [{
    "protocol": "vmess",
    "settings": {
      "vnext": [{
        "address": "server.com",
        "port": 443,
        "users": [{
          "id": "uuid"
        }]
      }]
    },
    "streamSettings": {
      "network": "tcp"    # ä¼ è¾“åè®®
    }
  }]
}
```

**Clash UDPï¼š**

```yaml
# å…¨å±€UDPè®¾ç½®
mixed-port: 7890
allow-lan: false
mode: rule
log-level: info
ipv6: false
enable-process: true

# èŠ‚ç‚¹UDPæ”¯æŒ
proxies:
  - name: "èŠ‚ç‚¹1"
    type: ss
    server: server.com
    port: 8388
    cipher: chacha20-ietf-poly1305
    password: password
    udp: true    # å¯ç”¨UDP

  - name: "èŠ‚ç‚¹2"
    type: vmess
    server: server.com
    port: 443
    uuid: your-uuid
    alterId: 0
    cipher: auto
    tls: true
    network: ws
    udp: true    # å¯ç”¨UDP
```

### 9.2.3 QUICåè®®

**QUIC (Quick UDP Internet Connections)ï¼š**

```
QUICç‰¹ç‚¹ï¼š
âœ“ åŸºäºUDP
âœ“ 0-RTTè¿æ¥å»ºç«‹
âœ“ å¤šè·¯å¤ç”¨
âœ“ å†…ç½®åŠ å¯†
âœ“ è¿æ¥è¿ç§»ï¼ˆIPå˜åŒ–ä¸æ–­çº¿ï¼‰

åº”ç”¨ï¼š
- HTTP/3åŸºäºQUIC
- GoogleæœåŠ¡å¹¿æ³›ä½¿ç”¨
- Chromeä¼˜å…ˆä½¿ç”¨QUIC
```

**V2Ray QUICä¼ è¾“ï¼š**

```json
{
  "streamSettings": {
    "network": "quic",
    "quicSettings": {
      "security": "aes-128-gcm",
      "key": "your-key-here",
      "header": {
        "type": "dtls"    # æˆ– "wechat-video"
      }
    },
    "security": "none"
  }
}
```

**ä¼˜åŠ¿ä¸é™åˆ¶ï¼š**

```
ä¼˜åŠ¿ï¼š
âœ“ ç§»åŠ¨ç½‘ç»œè¡¨ç°ä¼˜ç§€
âœ“ å¿«é€Ÿå»ºç«‹è¿æ¥
âœ“ æŠ—ä¸¢åŒ…èƒ½åŠ›å¼º

é™åˆ¶ï¼š
âœ— éƒ¨åˆ†ISPé™åˆ¶UDP
âœ— æŸäº›é˜²ç«å¢™é˜»æ­¢UDP
âœ— NATç¯å¢ƒå¯èƒ½æœ‰é—®é¢˜

å»ºè®®ï¼š
- WiFi/ç§»åŠ¨ç½‘ç»œï¼šæ¨è
- ä¼ä¸šç½‘ç»œï¼šå¯èƒ½è¢«é™åˆ¶
- å®¶åº­å®½å¸¦ï¼šé€šå¸¸å¯ç”¨
```

### 9.2.4 Hysteria 2åè®®

**Hysteria 2 - åŸºäºQUICçš„é«˜æ€§èƒ½ä»£ç†ï¼š**

```
æ ¸å¿ƒä¼˜åŠ¿ï¼š
âœ“ åŸºäºQUICåè®®ï¼ŒåŸç”ŸUDPæ”¯æŒ
âœ“ è‡ªé€‚åº”æ‹¥å¡æ§åˆ¶ç®—æ³•
âœ“ å¤šè·¯å¤ç”¨ï¼Œå•è¿æ¥é«˜æ•ˆ
âœ“ æŠ—ä¸¢åŒ…èƒ½åŠ›æå¼º
âœ“ ç§»åŠ¨ç½‘ç»œè¡¨ç°ä¼˜å¼‚

é€‚ç”¨åœºæ™¯ï¼š
â€¢ é«˜å»¶è¿Ÿç½‘ç»œç¯å¢ƒ
â€¢ å¼±ç½‘ç¯å¢ƒï¼ˆä¸¢åŒ…ç‡é«˜ï¼‰
â€¢ ç§»åŠ¨ç½‘ç»œï¼ˆ4G/5Gï¼‰
â€¢ éœ€è¦é«˜é€Ÿä¸Šä¼ çš„åœºæ™¯
```

**Hysteria 2æœåŠ¡ç«¯é…ç½®ï¼š**

```yaml
# /etc/hysteria/config.yaml
listen: :443

tls:
  cert: /path/to/cert.pem
  key: /path/to/key.pem

auth:
  type: password
  password: your-strong-password

masquerade:
  type: proxy
  proxy:
    url: https://www.bing.com
    rewriteHost: true

bandwidth:
  up: 100 mbps    # æœåŠ¡å™¨ä¸Šè¡Œå¸¦å®½
  down: 100 mbps  # æœåŠ¡å™¨ä¸‹è¡Œå¸¦å®½

quic:
  initStreamReceiveWindow: 8388608
  maxStreamReceiveWindow: 8388608
  initConnReceiveWindow: 20971520
  maxConnReceiveWindow: 20971520
```

**Hysteria 2å®¢æˆ·ç«¯é…ç½®ï¼š**

```yaml
server: your-server.com:443

auth: your-strong-password

tls:
  sni: your-server.com
  insecure: false

bandwidth:
  up: 50 mbps     # å®¢æˆ·ç«¯ä¸Šè¡Œå¸¦å®½
  down: 200 mbps  # å®¢æˆ·ç«¯ä¸‹è¡Œå¸¦å®½

socks5:
  listen: 127.0.0.1:1080

http:
  listen: 127.0.0.1:8080
```

**Hysteria 2ä¼˜åŒ–å»ºè®®ï¼š**

```
å¸¦å®½è®¾ç½®æŠ€å·§ï¼š
â€¢ è®¾ç½®ä¸ºå®é™…å¸¦å®½çš„80-90%
â€¢ ä¸Šè¡Œå¸¦å®½å°¤å…¶é‡è¦ï¼ˆå½±å“ACKåŒ…ï¼‰
â€¢ å¯ä»¥é€šè¿‡æµ‹é€Ÿå·¥å…·ç¡®å®šå®é™…å¸¦å®½

æ€§èƒ½è°ƒä¼˜ï¼š
â€¢ initStreamReceiveWindowï¼šåˆå§‹æµçª—å£
  - é»˜è®¤8MBï¼Œé«˜å¸¦å®½å¯è°ƒè‡³16MB
â€¢ maxConnReceiveWindowï¼šæœ€å¤§è¿æ¥çª—å£
  - é»˜è®¤20MBï¼Œé«˜å»¶è¿Ÿå¯è°ƒè‡³40MB

ä¼ªè£…é…ç½®ï¼š
â€¢ ä½¿ç”¨masqueradeä¼ªè£…æˆæ­£å¸¸HTTPSç½‘ç«™
â€¢ æ¨èä¼ªè£…ä¸ºå¤§å‹ç½‘ç«™ï¼ˆå¦‚Bingã€å¿…åº”ï¼‰
â€¢ é…ç½®rewriteHostç¡®ä¿å®Œç¾ä¼ªè£…

ä¸å…¶ä»–åè®®å¯¹æ¯”ï¼š
Hysteria 2 vs QUICï¼š
âœ“ æ›´æ¿€è¿›çš„æ‹¥å¡æ§åˆ¶
âœ“ ä¸“ä¸ºä»£ç†åœºæ™¯ä¼˜åŒ–
âœ“ å¼±ç½‘ç¯å¢ƒä¸‹é€Ÿåº¦æ›´å¿«

Hysteria 2 vs mKCPï¼š
âœ“ æ›´æˆç†Ÿçš„åè®®æ ˆ
âœ“ æ›´å¥½çš„å¸¦å®½åˆ©ç”¨ç‡
âœ“ æ›´å¼ºçš„æŠ—æ£€æµ‹èƒ½åŠ›
```

### 9.2.5 UDPåŠ é€Ÿå®æˆ˜

**mKCPï¼ˆKCP over UDPï¼‰ï¼š**

```json
{
  "streamSettings": {
    "network": "mkcp",
    "kcpSettings": {
      "mtu": 1350,
      "tti": 50,
      "uplinkCapacity": 12,      # ä¸Šè¡Œå¸¦å®½ï¼ˆMBï¼‰
      "downlinkCapacity": 100,   # ä¸‹è¡Œå¸¦å®½ï¼ˆMBï¼‰
      "congestion": true,        # æ‹¥å¡æ§åˆ¶
      "readBufferSize": 2,
      "writeBufferSize": 2,
      "header": {
        "type": "wechat-video"   # ä¼ªè£…ç±»å‹
      }
    }
  }
}
```

**mKCPå‚æ•°ä¼˜åŒ–ï¼š**

```json
{
  "kcpSettings": {
    // åŸºç¡€å‚æ•°
    "mtu": 1350,           # æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆä¸å»ºè®®ä¿®æ”¹ï¼‰
    "tti": 50,             # ä¼ è¾“æ—¶é—´é—´éš”ï¼Œè¶Šå°è¶Šå¿«ä½†æµé‡è¶Šå¤§ï¼ˆ10-100ï¼‰
    
    // å¸¦å®½è®¾ç½®ï¼ˆå…³é”®ï¼‰
    "uplinkCapacity": 5,   # ä½ çš„ä¸Šè¡Œå¸¦å®½ï¼ˆMB/sï¼‰
    "downlinkCapacity": 20,# ä½ çš„ä¸‹è¡Œå¸¦å®½ï¼ˆMB/sï¼‰
    
    // æ‹¥å¡æ§åˆ¶
    "congestion": true,    # å¯ç”¨æ‹¥å¡æ§åˆ¶ï¼ˆæ¨èï¼‰
    
    // ç¼“å†²åŒº
    "readBufferSize": 2,   # è¯»å–ç¼“å†²åŒºï¼ˆMBï¼‰
    "writeBufferSize": 2,  # å†™å…¥ç¼“å†²åŒºï¼ˆMBï¼‰
    
    // ä¼ªè£…
    "header": {
      "type": "wechat-video"  # ä¼ªè£…æˆå¾®ä¿¡è§†é¢‘é€šè¯
      // å…¶ä»–é€‰é¡¹ï¼šnone, srtp, utp, dtls, wireguard
    }
  }
}

åœºæ™¯æ¨èï¼š

æ¸¸æˆåŠ é€Ÿï¼š
tti = 10-20ï¼ˆä½å»¶è¿Ÿï¼‰
congestion = falseï¼ˆæœ€å¤§é€Ÿåº¦ï¼‰

è§†é¢‘é€šè¯ï¼š
tti = 20-30ï¼ˆå¹³è¡¡ï¼‰
congestion = trueï¼ˆç¨³å®šï¼‰

æ—¥å¸¸ä½¿ç”¨ï¼š
tti = 50ï¼ˆé»˜è®¤ï¼‰
congestion = trueï¼ˆçœæµé‡ï¼‰
```

## 9.3 WebSocket+TLSä¼ªè£…

### 9.3.1 ä¸ºä»€ä¹ˆä½¿ç”¨WebSocket+TLS

**ä¼˜åŠ¿ï¼š**

```
1. CDNå‹å¥½
   å¯ä»¥é€šè¿‡Cloudflareç­‰CDN
   éšè—çœŸå®æœåŠ¡å™¨IP

2. æµé‡ç‰¹å¾
   çœ‹èµ·æ¥åƒæ­£å¸¸HTTPSç½‘ç«™æµé‡
   éš¾ä»¥è¢«è¯†åˆ«å’Œå±è”½

3. ç«¯å£å¤ç”¨
   ä¸ç½‘ç«™å…±ç”¨443ç«¯å£
   é™ä½è¢«æ£€æµ‹çš„å¯èƒ½æ€§

4. å…¼å®¹æ€§å¥½
   å‡ ä¹æ‰€æœ‰ç½‘ç»œç¯å¢ƒéƒ½æ”¯æŒ
   ä¼ä¸šç½‘ç»œã€å…¬å…±WiFié€šå¸¸æ”¾è¡Œ
```

### 9.3.2 V2Ray WebSocket+TLSé…ç½®

**æœåŠ¡å™¨ç«¯é…ç½®ï¼š**

```json
{
  "inbounds": [{
    "port": 10000,
    "listen": "127.0.0.1",
    "protocol": "vmess",
    "settings": {
      "clients": [{
        "id": "your-uuid-here",
        "alterId": 0
      }]
    },
    "streamSettings": {
      "network": "ws",
      "wsSettings": {
        "path": "/v2ray"    # WebSocketè·¯å¾„
      }
    }
  }],
  "outbounds": [{
    "protocol": "freedom"
  }]
}
```

**Nginxåå‘ä»£ç†é…ç½®ï¼š**

```nginx
server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /path/to/fullchain.pem;
    ssl_certificate_key /path/to/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    # ç½‘ç«™æ ¹ç›®å½•ï¼ˆä¼ªè£…ï¼‰
    root /var/www/html;
    index index.html;
    
    # æ­£å¸¸ç½‘ç«™è®¿é—®
    location / {
        try_files $uri $uri/ =404;
    }
    
    # V2Ray WebSocketä»£ç†
    location /v2ray {
        if ($http_upgrade != "websocket") {
            return 404;
        }
        proxy_redirect off;
        proxy_pass http://127.0.0.1:10000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

# HTTPè‡ªåŠ¨è·³è½¬HTTPS
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}
```

**å®¢æˆ·ç«¯é…ç½®ï¼š**

```json
{
  "outbounds": [{
    "protocol": "vmess",
    "settings": {
      "vnext": [{
        "address": "your-domain.com",
        "port": 443,
        "users": [{
          "id": "your-uuid-here",
          "alterId": 0
        }]
      }]
    },
    "streamSettings": {
      "network": "ws",
      "security": "tls",
      "tlsSettings": {
        "serverName": "your-domain.com",
        "allowInsecure": false
      },
      "wsSettings": {
        "path": "/v2ray",
        "headers": {
          "Host": "your-domain.com"
        }
      }
    }
  }]
}
```

### 9.3.3 ä½¿ç”¨Caddyç®€åŒ–é…ç½®

**Caddyè‡ªåŠ¨HTTPSï¼š**

```
# Caddyfileé…ç½®
your-domain.com {
    # æ­£å¸¸ç½‘ç«™
    root * /var/www/html
    file_server
    
    # V2Rayåå‘ä»£ç†
    @v2ray {
        path /v2ray
        header Connection *Upgrade*
        header Upgrade websocket
    }
    reverse_proxy @v2ray localhost:10000
}

# Caddyè‡ªåŠ¨ï¼š
# âœ“ ç”³è¯·Let's Encryptè¯ä¹¦
# âœ“ è‡ªåŠ¨ç»­æœŸ
# âœ“ å¼ºåˆ¶HTTPS
# âœ“ HTTP/2æ”¯æŒ
```

**å¯åŠ¨Caddyï¼š**

```bash
# å®‰è£…Caddy
curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg
curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list
sudo apt update
sudo apt install caddy

# ç¼–è¾‘Caddyfile
sudo nano /etc/caddy/Caddyfile

# å¯åŠ¨Caddy
sudo systemctl start caddy
sudo systemctl enable caddy

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status caddy
```

## 9.4 CDNä¸­è½¬ä¼˜åŒ–

### 9.4.1 CDNä¸­è½¬åŸç†

**å·¥ä½œæµç¨‹ï¼š**

```
ä¼ ç»Ÿç›´è¿ï¼š
ç”¨æˆ· â”€â”€â”€â”€â”€â”€â–º VPSæœåŠ¡å™¨ â”€â”€â”€â”€â”€â”€â–º äº’è”ç½‘
      ç›´æ¥è¿æ¥     (IPå®¹æ˜“è¢«å¢™)

CDNä¸­è½¬ï¼š
ç”¨æˆ· â”€â”€â”€â”€â”€â”€â–º Cloudflare CDN â”€â”€â”€â”€â”€â”€â–º æºç«™VPS â”€â”€â”€â”€â”€â”€â–º äº’è”ç½‘
      HTTPS         (éšè—çœŸå®IP)        ä»£ç†æµé‡

ä¼˜åŠ¿ï¼š
âœ“ éšè—çœŸå®æœåŠ¡å™¨IP
âœ“ Cloudflareå…¨çƒèŠ‚ç‚¹å°±è¿‘æ¥å…¥
âœ“ å…è´¹SSLè¯ä¹¦
âœ“ DDoSé˜²æŠ¤
âœ“ æµé‡ç‰¹å¾åƒæ­£å¸¸HTTPS
```

### 9.4.2 Cloudflare CDNé…ç½®

**å‰ææ¡ä»¶ï¼š**
```
âœ“ ä¸€ä¸ªåŸŸå
âœ“ WebSocket+TLSé…ç½®çš„V2Ray
âœ“ Cloudflareè´¦å·ï¼ˆå…è´¹ï¼‰
```

**é…ç½®æ­¥éª¤ï¼š**

```
1. æ·»åŠ åŸŸååˆ°Cloudflare
   - ç™»å½•Cloudflare
   - æ·»åŠ ç«™ç‚¹ â†’ è¾“å…¥åŸŸå
   - é€‰æ‹©Freeè®¡åˆ’
   - ä¿®æ”¹åŸŸåDNSæœåŠ¡å™¨åˆ°Cloudflare

2. DNSè®¾ç½®
   - æ·»åŠ Aè®°å½•
     åç§°ï¼šcdnï¼ˆæˆ–å…¶ä»–å­åŸŸåï¼‰
     å†…å®¹ï¼šä½ çš„VPS IP
     ä»£ç†çŠ¶æ€ï¼šå·²ä»£ç†ï¼ˆæ©™è‰²äº‘æœµï¼‰
   
3. SSL/TLSè®¾ç½®
   - åŠ å¯†æ¨¡å¼ï¼šå®Œå…¨ï¼ˆä¸¥æ ¼ï¼‰
   - è¾¹ç¼˜è¯ä¹¦ï¼šè‡ªåŠ¨HTTPSé‡å†™ï¼ˆå¼€å¯ï¼‰

4. ç½‘ç»œè®¾ç½®
   - WebSocketï¼šå¼€å¯
   - HTTP/2ï¼šå¼€å¯
   - gRPCï¼šå¼€å¯ï¼ˆå¦‚æœç”¨gRPCï¼‰

5. é€Ÿåº¦ä¼˜åŒ–
   - è‡ªåŠ¨å‹ç¼©ï¼šå¼€å¯
   - Brotliï¼šå¼€å¯
   - HTTP/3 (QUIC)ï¼šå¼€å¯
```

**å®¢æˆ·ç«¯é…ç½®ï¼š**

```json
{
  "outbounds": [{
    "protocol": "vmess",
    "settings": {
      "vnext": [{
        "address": "cdn.your-domain.com",    # ä½¿ç”¨CDNåŸŸå
        "port": 443,
        "users": [{
          "id": "your-uuid"
        }]
      }]
    },
    "streamSettings": {
      "network": "ws",
      "security": "tls",
      "tlsSettings": {
        "serverName": "cdn.your-domain.com"
      },
      "wsSettings": {
        "path": "/v2ray",
        "headers": {
          "Host": "cdn.your-domain.com"
        }
      }
    }
  }]
}
```

### 9.4.3 CDNä¼˜é€‰IP

**ä¸ºä»€ä¹ˆéœ€è¦ä¼˜é€‰IPï¼Ÿ**

```
é—®é¢˜ï¼š
Cloudflareåˆ†é…çš„CDNèŠ‚ç‚¹å¯èƒ½ï¼š
âœ— å»¶è¿Ÿé«˜
âœ— é€Ÿåº¦æ…¢
âœ— ä¸¢åŒ…ä¸¥é‡

è§£å†³ï¼š
é€šè¿‡ä¼˜é€‰IPæ‰¾åˆ°æœ€å¿«çš„CDNèŠ‚ç‚¹
```

**CloudflareSpeedTestå·¥å…·ï¼š**

```bash
# Windowsä¸‹è½½
https://github.com/XIU2/CloudflareSpeedTest/releases

# è¿è¡Œæµ‹é€Ÿ
CloudflareST.exe

# å‚æ•°è¯´æ˜
CloudflareST.exe \
  -n 200              # æµ‹é€Ÿçº¿ç¨‹æ•°
  -t 4                # å»¶è¿Ÿæµ‹é€Ÿæ¬¡æ•°
  -dn 10              # ä¸‹è½½æµ‹é€Ÿæ•°é‡
  -url https://...    # æµ‹é€Ÿæ–‡ä»¶URL

# ç­‰å¾…æµ‹è¯•å®Œæˆï¼Œè·å¾—æœ€ä¼˜IPåˆ—è¡¨
```

**ä½¿ç”¨ä¼˜é€‰IPï¼š**

```json
// V2Rayé…ç½®
{
  "outbounds": [{
    "protocol": "vmess",
    "settings": {
      "vnext": [{
        "address": "104.18.32.167",    # ä½¿ç”¨ä¼˜é€‰çš„IP
        "port": 443,
        "users": [{
          "id": "your-uuid"
        }]
      }]
    },
    "streamSettings": {
      "network": "ws",
      "security": "tls",
      "tlsSettings": {
        "serverName": "cdn.your-domain.com"   # Hostä»ä½¿ç”¨åŸŸå
      },
      "wsSettings": {
        "path": "/v2ray",
        "headers": {
          "Host": "cdn.your-domain.com"       # Hostä½¿ç”¨åŸŸå
        }
      }
    }
  }]
}
```

**æ¨èä¼˜é€‰IPï¼ˆä¾›å‚è€ƒï¼‰ï¼š**

```
å¸¸ç”¨IPæ®µï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š

ç”µä¿¡ï¼š
104.16.160.0/24    # æ´›æ‰çŸ¶
104.17.0.0/16
162.159.0.0/16
172.64.0.0/24      # æ—§é‡‘å±±

è”é€šï¼š
104.16.0.0/16
108.162.236.0/24   # ç¾å›½
104.20.157.0/24    # æ—¥æœ¬

ç§»åŠ¨ï¼š
172.64.32.0/24     # é¦™æ¸¯
172.64.0.0/16
141.101.115.0/24
104.28.14.0/24     # æ–°åŠ å¡

é‡è¦æç¤ºï¼š
âš ï¸ IPæ®µä¼šå˜åŒ–ï¼Œä¸Šè¿°ä»…ä¸ºå‚è€ƒ
âš ï¸ ä¸åŒåœ°åŒºã€ä¸åŒè¿è¥å•†ç»“æœå·®å¼‚å¤§
âœ“ å¿…é¡»è‡ªå·±æµ‹è¯•æ‰¾åˆ°æœ€ä¼˜IP
âœ“ å»ºè®®æ¯æœ’1-2å‘¨é‡æ–°æµ‹è¯•
âœ“ ä¸åŒæ—¶æ®µæœ€ä¼˜IPå¯èƒ½ä¸åŒ
```

**é«˜çº§ä¼˜åŒ–æŠ€å·§ï¼š**

```
1. åŒºåŸŸé”å®šIPæŠ€å·§ï¼š
â€¢ ä½¿ç”¨Cloudflare Workersè®¾ç½®å›ºå®šè½åœ°IP
â€¢ å¯è§£é”ç‰¹å®šåŒºåŸŸæœåŠ¡ï¼ˆå¦‚ChatGPTã€Netflixï¼‰
â€¢ å‚è€ƒé¡¹ç›®ï¼šgithub.com/yonggekkk/Cloudflare-vless-trojan

2. æ™ºèƒ½è·¯ç”±ï¼š
â€¢ ä¸ºä¸åŒç›®æ ‡é…ç½®ä¸åŒCDNèŠ‚ç‚¹
â€¢ ç¾å›½æœåŠ¡ä½¿ç”¨ç¾å›½èŠ‚ç‚¹
â€¢ äºšæ´²æœåŠ¡ä½¿ç”¨äºšæ´²èŠ‚ç‚¹

3. å¤šä¸ªIPè½®è¯¢ï¼š
â€¢ é…ç½®å¤šä¸ªä¼˜é€‰IP
â€¢ è‡ªåŠ¨æ•…éšœè½¬ç§»
â€¢ æé«˜å¯ç”¨æ€§

4. æµ‹é€Ÿå·¥å…·é€‰æ‹©ï¼š
æ¨èå·¥å…·ï¼š
â€¢ CloudflareSpeedTestï¼šhttps://github.com/XIU2/CloudflareSpeedTest
â€¢ æ”¯æŒWindows/Linux/macOS
â€¢ è‡ªåŠ¨å¯¼å‡ºæœ€ä¼˜IPåˆ—è¡¨
â€¢ å¯è‡ªå®šä¹‰æµ‹è¯•å‚æ•°
```

### 9.4.4 gRPC over CDN

**gRPCä¼˜åŠ¿ï¼š**

```
ç›¸æ¯”WebSocketï¼š
âœ“ HTTP/2å¤šè·¯å¤ç”¨
âœ“ æ›´å¥½çš„æ€§èƒ½
âœ“ æ›´çœŸå®çš„æµé‡ç‰¹å¾
âœ“ CloudflareåŸç”Ÿæ”¯æŒ
```

**V2Ray gRPCé…ç½®ï¼š**

```json
// æœåŠ¡å™¨
{
  "inbounds": [{
    "port": 10000,
    "listen": "127.0.0.1",
    "protocol": "vmess",
    "settings": {
      "clients": [{
        "id": "your-uuid"
      }]
    },
    "streamSettings": {
      "network": "grpc",
      "grpcSettings": {
        "serviceName": "your-service-name",
        "multiMode": true    # å¤šè·¯å¤ç”¨
      }
    }
  }]
}

// Nginxé…ç½®
server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    ssl_certificate /path/to/cert;
    ssl_certificate_key /path/to/key;
    
    location / {
        root /var/www/html;
    }
    
    location /your-service-name {
        grpc_pass grpc://127.0.0.1:10000;
        grpc_set_header X-Real-IP $remote_addr;
    }
}

// å®¢æˆ·ç«¯
{
  "outbounds": [{
    "protocol": "vmess",
    "settings": {
      "vnext": [{
        "address": "cdn.your-domain.com",
        "port": 443,
        "users": [{"id": "your-uuid"}]
      }]
    },
    "streamSettings": {
      "network": "grpc",
      "security": "tls",
      "tlsSettings": {
        "serverName": "cdn.your-domain.com"
      },
      "grpcSettings": {
        "serviceName": "your-service-name",
        "multiMode": true
      }
    }
  }]
}
```

## 9.5 å¤šå±‚ä»£ç†é“¾

### 9.5.1 ä»£ç†é“¾æ¦‚å¿µ

**ä»€ä¹ˆæ˜¯ä»£ç†é“¾ï¼Ÿ**

```
å•å±‚ä»£ç†ï¼š
ç”¨æˆ· â†’ ä»£ç†1 â†’ ç›®æ ‡ç½‘ç«™

ä¸¤å±‚ä»£ç†ï¼š
ç”¨æˆ· â†’ ä»£ç†1 â†’ ä»£ç†2 â†’ ç›®æ ‡ç½‘ç«™

ä¸‰å±‚ä»£ç†ï¼š
ç”¨æˆ· â†’ ä»£ç†1 â†’ ä»£ç†2 â†’ ä»£ç†3 â†’ ç›®æ ‡ç½‘ç«™

ç”¨é€”ï¼š
âœ“ å¢å¼ºéšç§ï¼ˆå¤šè·³ï¼‰
âœ“ çªç ´å¤šå±‚å°é”
âœ“ åœ°åŒºè·³è½¬
âœ— é€Ÿåº¦é™ä½
âœ— ç¨³å®šæ€§ä¸‹é™
```

### 9.5.2 V2Rayä»£ç†é“¾é…ç½®

**åœºæ™¯ï¼šå›½å†…VPSä¸­è½¬ + å›½å¤–VPS**

```json
// å®¢æˆ·ç«¯é…ç½®
{
  "outbounds": [
    {
      "tag": "proxy1",
      "protocol": "vmess",
      "settings": {
        "vnext": [{
          "address": "china-vps.com",    # å›½å†…ä¸­è½¬VPS
          "port": 443,
          "users": [{"id": "uuid1"}]
        }]
      },
      "streamSettings": {
        "network": "ws",
        "security": "tls"
      },
      "proxySettings": {
        "tag": "proxy2"    # é€šè¿‡proxy2è¿æ¥
      }
    },
    {
      "tag": "proxy2",
      "protocol": "vmess",
      "settings": {
        "vnext": [{
          "address": "foreign-vps.com",  # å›½å¤–VPS
          "port": 443,
          "users": [{"id": "uuid2"}]
        }]
      },
      "streamSettings": {
        "network": "ws",
        "security": "tls"
      }
    }
  ]
}
```

### 9.5.3 IPLC/IEPLä¸“çº¿

**ä»€ä¹ˆæ˜¯ä¸“çº¿ï¼Ÿ**

```
IPLC (International Private Leased Circuit)ï¼š
å›½é™…ä¸“çº¿ï¼Œç‚¹å¯¹ç‚¹ç›´è¿

ç‰¹ç‚¹ï¼š
âœ“ ä¸ç»è¿‡GFW
âœ“ é€Ÿåº¦æå¿«
âœ“ å»¶è¿Ÿç¨³å®š
âœ“ ä¸é™æµé‡ï¼ˆé€šå¸¸ï¼‰
âœ— ä»·æ ¼æ˜‚è´µ

ä½¿ç”¨åœºæ™¯ï¼š
- ä¼ä¸šè·¨å›½é€šä¿¡
- æ¸¸æˆä¸»æ’­
- å¤–è´¸ä»ä¸šè€…
- é«˜è¦æ±‚ç”¨æˆ·
```

**ä¸“çº¿+ä¸­è½¬æ–¹æ¡ˆï¼š**

```
æœ¬åœ° â†’ å›½å†…ä¸­è½¬ â†’ IPLCä¸“çº¿ â†’ é¦™æ¸¯/æ—¥æœ¬ â†’ äº’è”ç½‘

ä¼˜åŠ¿ï¼š
âœ“ å›½å†…æ®µé€Ÿåº¦å¿«
âœ“ å›½é™…æ®µä¸è¿‡å¢™
âœ“ ç»¼åˆä½“éªŒæœ€ä½³

æˆæœ¬ï¼š
çº¦ï¿¥50-200/æœˆï¼ˆ100-500Mbpsï¼‰
```

## 9.6 å›½å†…å¤–åˆ†æµæœ€ä½³å®è·µ

### 9.6.1 å®Œæ•´åˆ†æµæ–¹æ¡ˆ

**Clashå®Œæ•´é…ç½®ç¤ºä¾‹ï¼š**

```yaml
# ç«¯å£é…ç½®
mixed-port: 7890
allow-lan: false
bind-address: "*"
mode: rule
log-level: info
ipv6: false
external-controller: 127.0.0.1:9090
external-ui: folder

# DNSé…ç½®
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
    - localhost.ptlogin2.qq.com
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fallback:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4

# ä»£ç†ç»„
proxy-groups:
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    proxies:
      - "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹"
      - "DIRECT"
      
  - name: "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹"
      
  - name: "ğŸ“² Telegram"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹"
      
  - name: "ğŸ¬ æµåª’ä½“"
    type: select
    proxies:
      - "ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹"
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹"
      
  - name: "ğŸ Apple"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      
  - name: "â“‚ï¸ Microsoft"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      
  - name: "ğŸ® æ¸¸æˆå¹³å°"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      
  - name: "ğŸ¯ å…¨çƒç›´è¿"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      
  - name: "ğŸ›‘ å¹¿å‘Šæ‹¦æˆª"
    type: select
    proxies:
      - "REJECT"
      - "DIRECT"
      
  - name: "ğŸŸ æ¼ç½‘ä¹‹é±¼"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "DIRECT"

# è§„åˆ™
rules:
  # æœ¬åœ°ç½‘ç»œ
  - DOMAIN-SUFFIX,local,DIRECT
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  
  # å¹¿å‘Šæ‹¦æˆª
  - DOMAIN-KEYWORD,adservice,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - DOMAIN-KEYWORD,analytics,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - DOMAIN-SUFFIX,googlesyndication.com,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  
  # Telegram
  - DOMAIN-SUFFIX,t.me,ğŸ“² Telegram
  - DOMAIN-SUFFIX,telegram.org,ğŸ“² Telegram
  - IP-CIDR,91.108.4.0/22,ğŸ“² Telegram,no-resolve
  - IP-CIDR,91.108.56.0/22,ğŸ“² Telegram,no-resolve
  - IP-CIDR,149.154.160.0/20,ğŸ“² Telegram,no-resolve
  
  # æµåª’ä½“
  - DOMAIN-SUFFIX,netflix.com,ğŸ¬ æµåª’ä½“
  - DOMAIN-SUFFIX,youtube.com,ğŸ¬ æµåª’ä½“
  - DOMAIN-KEYWORD,youtube,ğŸ¬ æµåª’ä½“
  - DOMAIN-SUFFIX,hulu.com,ğŸ¬ æµåª’ä½“
  - DOMAIN-SUFFIX,hbo.com,ğŸ¬ æµåª’ä½“
  - DOMAIN-SUFFIX,disney.com,ğŸ¬ æµåª’ä½“
  
  # Apple
  - DOMAIN-SUFFIX,apple.com,ğŸ Apple
  - DOMAIN-SUFFIX,icloud.com,ğŸ Apple
  - DOMAIN-SUFFIX,apple-dns.net,ğŸ Apple
  
  # Microsoft
  - DOMAIN-SUFFIX,microsoft.com,â“‚ï¸ Microsoft
  - DOMAIN-SUFFIX,windows.com,â“‚ï¸ Microsoft
  - DOMAIN-SUFFIX,office.com,â“‚ï¸ Microsoft
  
  # æ¸¸æˆå¹³å°
  - DOMAIN-SUFFIX,steam-chat.com,ğŸ® æ¸¸æˆå¹³å°
  - DOMAIN-SUFFIX,epicgames.com,ğŸ® æ¸¸æˆå¹³å°
  
  # Google
  - DOMAIN-SUFFIX,google.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,googleapis.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,gstatic.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # å›½å¤–æœåŠ¡
  - DOMAIN-SUFFIX,github.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,githubusercontent.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,twitter.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,facebook.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,instagram.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # å›½å†…æœåŠ¡
  - DOMAIN-SUFFIX,cn,ğŸ¯ å…¨çƒç›´è¿
  - DOMAIN-KEYWORD,baidu,ğŸ¯ å…¨çƒç›´è¿
  - DOMAIN-KEYWORD,taobao,ğŸ¯ å…¨çƒç›´è¿
  - DOMAIN-KEYWORD,alipay,ğŸ¯ å…¨çƒç›´è¿
  - DOMAIN-SUFFIX,qq.com,ğŸ¯ å…¨çƒç›´è¿
  - DOMAIN-SUFFIX,bilibili.com,ğŸ¯ å…¨çƒç›´è¿
  
  # GeoIP
  - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿
  
  # å…œåº•è§„åˆ™
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
```

### 9.6.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®

**é…ç½®ä¼˜åŒ–ï¼š**

```yaml
# 1. ä½¿ç”¨fake-ipæ¨¡å¼ï¼ˆæå‡é€Ÿåº¦ï¼‰
dns:
  enhanced-mode: fake-ip

# 2. å¯ç”¨è§„åˆ™é›†ç¼“å­˜
# è§„åˆ™é›†ä¼šè‡ªåŠ¨ç¼“å­˜åœ¨æœ¬åœ°

# 3. å‡å°‘ä¸å¿…è¦çš„è§„åˆ™
# ä½¿ç”¨è§„åˆ™é›†ä»£æ›¿å¤§é‡å•æ¡è§„åˆ™

# 4. ä¼˜åŒ–ä»£ç†ç»„
# è‡ªåŠ¨é€‰æ‹©ç»„ä¸è¦åŒ…å«å¤ªå¤šèŠ‚ç‚¹ï¼ˆå»ºè®®<10ä¸ªï¼‰
```

**ç³»ç»Ÿä¼˜åŒ–ï¼š**

```
1. å…³é—­ä¸å¿…è¦çš„æ€æ¯’è½¯ä»¶å®æ—¶ä¿æŠ¤
2. æ’é™¤ä»£ç†è½¯ä»¶ç›®å½•
3. ä½¿ç”¨SSDå­˜å‚¨é…ç½®æ–‡ä»¶
4. å®šæœŸæ¸…ç†æ—¥å¿—æ–‡ä»¶
5. ä¿æŒè½¯ä»¶æ›´æ–°
```

---

## æœ¬ç« å°ç»“

æœ¬ç« ä»‹ç»äº†å¤šç§è¿›é˜¶ä¼˜åŒ–æŠ€å·§ï¼š

**æ ¸å¿ƒè¦ç‚¹ï¼š**

1. **TCPä¼˜åŒ–**ï¼š
    - BBRç®—æ³•åŸç†å’Œéƒ¨ç½²
    - å®¢æˆ·ç«¯TCPå‚æ•°ä¼˜åŒ–
    - æ€§èƒ½æå‡æ˜¾è‘—

2. **UDPåŠ é€Ÿ**ï¼š
    - UDPåè®®é‡è¦æ€§
    - mKCP/QUICé…ç½®
    - å‚æ•°è°ƒä¼˜

3. **WebSocket+TLS**ï¼š
    - æµé‡ä¼ªè£…
    - Nginx/Caddyåå‘ä»£ç†
    - ç«¯å£å¤ç”¨

4. **CDNä¸­è½¬**ï¼š
    - Cloudflare CDNé…ç½®
    - ä¼˜é€‰IPæŠ€æœ¯
    - gRPCä¼ è¾“

5. **å¤šå±‚ä»£ç†**ï¼š
    - ä»£ç†é“¾é…ç½®
    - IPLCä¸“çº¿
    - åœºæ™¯åº”ç”¨

6. **åˆ†æµå®è·µ**ï¼š
    - å®Œæ•´é…ç½®æ–¹æ¡ˆ
    - æ€§èƒ½ä¼˜åŒ–
    - æœ€ä½³å®è·µ

**ä¼˜åŒ–åŸåˆ™ï¼š**

```
1. æ ¹æ®éœ€æ±‚é€‰æ‹©
   ä¸æ˜¯æ‰€æœ‰ä¼˜åŒ–éƒ½é€‚åˆæ‰€æœ‰äºº

2. å¾ªåºæ¸è¿›
   å…ˆåŸºç¡€é…ç½® â†’ å†é€æ­¥ä¼˜åŒ–

3. æµ‹è¯•éªŒè¯
   æ¯æ¬¡ä¼˜åŒ–åæµ‹è¯•æ•ˆæœ

4. æƒè¡¡å–èˆ
   é€Ÿåº¦ vs éšè”½æ€§
   æ€§èƒ½ vs ç¨³å®šæ€§

5. æŒç»­å­¦ä¹ 
   æŠ€æœ¯ä¸æ–­æ›´æ–°
   ä¿æŒå…³æ³¨æ–°æ–¹æ¡ˆ
```

è‡³æ­¤ï¼Œç¬¬ä¸‰éƒ¨åˆ†"é«˜çº§é…ç½®ç¯‡"å…¨éƒ¨å®Œæˆï¼

---

**å®è·µä»»åŠ¡ï¼š**

1. åœ¨VPSä¸Šå¯ç”¨BBR
2. é…ç½®WebSocket+TLS+CDN
3. æµ‹è¯•ä¼˜é€‰IPæ•ˆæœ
4. ä¼˜åŒ–åˆ†æµè§„åˆ™
5. å¯¹æ¯”ä¼˜åŒ–å‰åæ€§èƒ½

**å»¶ä¼¸é˜…è¯»ï¼š**

- BBRç®—æ³•è®ºæ–‡
- HTTP/3ä¸QUIC
- Cloudflare Workers
- ç½‘ç»œæ€§èƒ½æµ‹è¯•æ–¹æ³•
