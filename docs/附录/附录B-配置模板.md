# 第10章 VPS选购指南

自建代理服务器需要租用VPS（Virtual Private Server，虚拟专用服务器）。本章将指导你如何选择合适的VPS供应商和配置。

## 10.1 VPS供应商对比

### 10.1.1 主流VPS供应商

**国际大厂：**

**1. Vultr**
```
优势：
✓ 全球18+机房
✓ 按小时计费，随时销毁
✓ 支持支付宝/微信支付
✓ 新用户送$100（有条件）
✓ 开通快速（1分钟）

配置与价格：
$6/月  - 1核 1G 内存 25G SSD 1TB流量
$12/月 - 1核 2G 内存 55G SSD 2TB流量
$24/月 - 2核 4G 内存 80G SSD 3TB流量

推荐机房：
- 东京（延迟低，但易被墙）
- 洛杉矶（性价比高）
- 新加坡（稳定）

官网：https://www.vultr.com
```

**2. DigitalOcean**
```
优势：
✓ 老牌稳定
✓ 文档详细
✓ 社区活跃
✓ 界面友好
✗ 价格稍贵
✗ 需信用卡验证

配置与价格：
$6/月  - 1核 1G 内存 25G SSD 1TB流量
$12/月 - 1核 2G 内存 50G SSD 2TB流量
$24/月 - 2核 4G 内存 80G SSD 4TB流量

推荐机房：
- 旧金山
- 新加坡
- 纽约

官网：https://www.digitalocean.com
```

**3. Linode**
```
优势：
✓ 性能优秀
✓ 稳定可靠
✓ 客服响应快
✓ 免费备份

配置与价格：
$5/月  - 1核 1G 内存 25G SSD 1TB流量
$10/月 - 1核 2G 内存 50G SSD 2TB流量
$20/月 - 2核 4G 内存 80G SSD 4TB流量

推荐机房：
- 东京
- 弗里蒙特
- 新加坡

官网：https://www.linode.com
```

**4. Bandwagon（搬瓦工）**
```
特点：
✓ 针对中国优化
✓ CN2 GIA线路
✓ 支持支付宝
✗ 价格较贵
✗ 经常缺货

配置与价格：
$49.99/年 - 1核 1G 内存 20G SSD 1TB流量（CN2）
$169.99/年 - 1核 1G 内存 20G SSD 1TB流量（CN2 GIA）

推荐机房：
- 洛杉矶 CN2 GIA

官网：https://bandwagonhost.com
```

**5. Hostwinds**
```
优势：
✓ 不限流量
✓ 支持支付宝
✓ 性价比高
✓ 可随时换IP（$3/次）

配置与价格：
$4.99/月 - 1核 1G 内存 30G SSD 无限流量
$8.99/月 - 1核 2G 内存 50G SSD 无限流量

推荐机房：
- 西雅图
- 达拉斯

官网：https://www.hostwinds.com
```

**6. AWS Lightsail**
```
优势：
✓ 亚马逊出品
✓ 稳定可靠
✓ 与AWS生态集成
✗ 配置复杂
✗ 价格不透明

配置与价格：
$3.5/月 - 1核 512M 内存 20G SSD 1TB流量
$5/月   - 1核 1G 内存 40G SSD 2TB流量
$10/月  - 1核 2G 内存 60G SSD 3TB流量

推荐机房：
- 东京
- 首尔
- 新加坡

官网：https://aws.amazon.com/lightsail/
```

### 10.1.2 供应商选择建议

**对比表：**

| 供应商 | 价格 | 性能 | 稳定性 | 易用性 | 支付方式 | 推荐度 |
|--------|------|------|--------|--------|---------|--------|
| **Vultr** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 支付宝/信用卡 | ⭐⭐⭐⭐⭐ |
| **DigitalOcean** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 信用卡 | ⭐⭐⭐⭐ |
| **Linode** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 信用卡/PayPal | ⭐⭐⭐⭐ |
| **搬瓦工** | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 支付宝 | ⭐⭐⭐ |
| **Hostwinds** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 支付宝/信用卡 | ⭐⭐⭐⭐ |
| **AWS** | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | 信用卡 | ⭐⭐⭐ |

**场景推荐：**

```
新手入门：
首选：Vultr
理由：支付方便、开通快、按小时计费、易上手

追求性能：
首选：Linode / DigitalOcean
理由：性能稳定、口碑好、文档齐全

追求性价比：
首选：Hostwinds
理由：不限流量、价格低、可换IP

中国优化：
首选：搬瓦工 CN2 GIA
理由：专线直连、速度快、延迟低
注意：价格贵、经常缺货

企业级需求：
首选：AWS Lightsail
理由：稳定可靠、可扩展性强
```

### 10.1.3 注册与购买流程

**Vultr注册购买示例：**

```
步骤1：注册账号
1. 访问 https://www.vultr.com
2. 点击 Create Account
3. 填写邮箱和密码
4. 验证邮箱

步骤2：充值
1. 登录后台
2. Billing → Make Payment
3. 选择支付方式：
   - Alipay（支付宝）
   - WeChat Pay（微信支付）
   - Credit Card（信用卡）
   - PayPal
4. 充值金额（建议$10起）

步骤3：部署服务器
1. Products → Deploy New Server
2. 选择服务器类型：Cloud Compute
3. 选择机房位置（Server Location）
   推荐：Tokyo、Los Angeles、Singapore
4. 选择操作系统（Server Type）
   推荐：Ubuntu 20.04 LTS / Debian 11
5. 选择配置（Server Size）
   推荐：$6/月（1GB内存）
6. 禁用IPv6（可选）
7. Server Hostname & Label（自定义名称）
8. Deploy Now（立即部署）

步骤4：等待开通
- 通常1-3分钟完成
- 状态变为Running即可使用
- 记录IP地址、用户名、密码
```

**注意事项：**

```
⚠️ IP被墙问题
- 新开VPS的IP可能已被墙
- 开通后立即测试连通性
- 如果被墙，立即删除重新开通
- Vultr可随时删除服务器，按小时计费

⚠️ 账号安全
- 使用强密码
- 启用两步验证（2FA）
- 不要分享账号信息

⚠️ 付款安全
- 优先使用支付宝/微信
- 信用卡注意盗刷风险
- 定期检查账单
```

## 10.2 地域选择策略

### 10.2.1 地理位置与延迟

**距离与延迟关系：**

```
物理定律：
光速 ≈ 300,000 km/s
光纤中实际速度 ≈ 200,000 km/s

理论延迟计算：
北京 → 东京（约2100km）
理论延迟 = 2100 / 200,000 × 2 ≈ 21ms

实际延迟（包含路由跳转）：
北京 → 东京：30-60ms
北京 → 洛杉矶：150-200ms
北京 → 纽约：200-250ms
北京 → 欧洲：250-350ms
```

**中国大陆用户延迟参考：**

| 机房位置 | 延迟范围 | 适用场景 | 推荐度 |
|---------|---------|---------|--------|
| **香港** | 5-30ms | 游戏、实时通信 | ⭐⭐⭐⭐⭐ |
| **日本** | 30-80ms | 日常使用、游戏 | ⭐⭐⭐⭐⭐ |
| **韩国** | 30-80ms | 游戏、流媒体 | ⭐⭐⭐⭐ |
| **新加坡** | 50-100ms | 平衡之选 | ⭐⭐⭐⭐⭐ |
| **美西** | 130-180ms | 日常使用 | ⭐⭐⭐⭐ |
| **美东** | 180-230ms | 流媒体 | ⭐⭐⭐ |
| **欧洲** | 250-350ms | 特定服务 | ⭐⭐ |

### 10.2.2 线路类型

**电信/联通/移动线路区别：**

**普通线路（163骨干网）：**
```
特点：
- 价格便宜
- 高峰期拥堵
- 绕路严重
- 丢包率高

适合：
- 预算有限
- 低峰期使用
- 非高要求用户
```

**CN2线路：**
```
CN2 GT（Global Transit）：
- 部分路由走CN2
- 价格适中
- 高峰期表现尚可

CN2 GIA（Global Internet Access）：
- 全程CN2网络
- 价格昂贵
- 速度快、延迟低
- 高峰期稳定

对比：
普通线路：$5-10/月
CN2 GT：   $10-20/月
CN2 GIA：  $30-100/月
```

**BGP多线：**
```
特点：
✓ 自动选择最优路由
✓ 电信/联通/移动都快
✓ 智能切换
✗ 价格较贵

推荐：
搬瓦工 CN2 GIA
```

### 10.2.3 机房推荐

**按需求选择：**

**游戏加速：**
```
首选：香港、日本、韩国
延迟要求：< 100ms
推荐机房：
- Vultr 东京
- Linode 东京
- Vultr 新加坡
```

**日常使用：**
```
首选：日本、新加坡、美西
延迟要求：< 200ms
推荐机房：
- Vultr 东京/洛杉矶
- DigitalOcean 旧金山
- Linode 弗里蒙特
```

**流媒体解锁：**
```
Netflix：美国原生IP
Disney+：美国、日本
HBO Max：美国

推荐机房：
- DigitalOcean 纽约
- Vultr 洛杉矶
- AWS 美西
```

**特定服务：**
```
ChatGPT/OpenAI：
- 支持大部分美国、欧洲、日本IP
- 避免：香港、印度、俄罗斯

Google：
- 任何地区都可以
- 推荐：新加坡、日本

GitHub：
- 任何地区都可以
- 推荐：美国、新加坡
```

### 10.2.4 IP被墙检测

**测试方法：**

```bash
# 本地ping测试
ping your-vps-ip

# 如果超时，可能被墙
# 进一步确认：

# 1. 使用在线工具
https://www.ping.pe/your-vps-ip
https://tools.ipip.net/ping.php

# 2. 使用国外服务器测试
# 如果国外能ping通，国内不通 = 被墙

# 3. TCP端口测试
telnet your-vps-ip 22

# 4. HTTP测试
curl -I http://your-vps-ip
```

**IP被墙后的处理：**

```
方案1：更换IP（推荐）
Vultr/DigitalOcean：
- 删除当前服务器
- 重新部署
- 免费获得新IP

Hostwinds：
- 付费更换IP（$3/次）

方案2：使用CDN中转
- 配置CloudFlare CDN
- 隐藏真实IP
- 参考第9章CDN配置

方案3：换服务商/机房
- 选择被墙概率低的机房
- 避免热门IP段
```

## 10.3 配置需求分析

### 10.3.1 个人使用配置

**单人使用：**

```
基础配置（$5-6/月）：
CPU：1核
内存：1GB
硬盘：20-25GB SSD
流量：500GB-1TB/月
带宽：1Gbps

适合：
✓ 日常浏览
✓ 偶尔看视频
✓ 轻度使用

性能：
- 同时连接：1-2设备
- 视频：720P流畅
- 下载：~5-10MB/s
```

**重度使用（$10-12/月）：**

```
推荐配置：
CPU：1-2核
内存：2GB
硬盘：50GB SSD
流量：2TB/月
带宽：1Gbps

适合：
✓ 高频使用
✓ 看高清视频
✓ 大文件下载

性能：
- 同时连接：3-5设备
- 视频：1080P流畅
- 下载：~10-20MB/s
```

### 10.3.2 多人共享配置

**2-5人共享：**

```
推荐配置（$20/月）：
CPU：2核
内存：4GB
硬盘：80GB SSD
流量：3-4TB/月
带宽：1Gbps

管理：
- 使用X-UI面板
- 设置流量限制
- 分配不同端口
```

**5-10人共享：**

```
推荐配置（$40/月）：
CPU：4核
内存：8GB
硬盘：160GB SSD
流量：5-6TB/月
带宽：1Gbps

注意：
⚠️ 合理分配流量
⚠️ 设置限速策略
⚠️ 监控使用情况
⚠️ 注意服务商TOS
```

### 10.3.3 流量计算

**流量消耗参考：**

```
网页浏览：
普通网页：~1-3MB/页
图片多的网页：~5-10MB/页
估算：100页/天 × 5MB ≈ 500MB/天 ≈ 15GB/月

视频观看：
YouTube 720P：~1.5GB/小时
YouTube 1080P：~3GB/小时
Netflix HD：~3GB/小时
Netflix 4K：~7GB/小时
估算：2小时/天 × 3GB ≈ 6GB/天 ≈ 180GB/月

文件下载：
软件/游戏：偶尔10-50GB
估算：20GB/月

总计：
轻度：15 + 60 + 0 ≈ 75GB/月（500GB套餐足够）
中度：15 + 180 + 10 ≈ 205GB/月（500GB-1TB）
重度：30 + 360 + 50 ≈ 440GB/月（1TB+）
```

**安全余量：**

```
建议选择流量为实际需求的2-3倍：

实际需求：200GB/月
推荐选择：500GB-1TB套餐

原因：
✓ 避免超额费用
✓ 预留升级空间
✓ 应对突发需求
```

### 10.3.4 性能测试

**VPS性能测试脚本：**

```bash
# 综合性能测试（推荐）
wget -qO- bench.sh | bash

# 或
curl -Lso- bench.sh | bash

# 测试内容：
- CPU性能
- 内存性能
- 硬盘I/O速度
- 网络速度（全球多节点）

# Superbench脚本
wget -qO- git.io/superbench.sh | bash

# 或
curl -Lso- git.io/superbench.sh | bash

# 测试内容更详细：
- 系统信息
- CPU性能（单核/多核）
- 内存测试
- 硬盘测试（顺序/随机读写）
- 网络测试（上传/下载）
```

**解读测试结果：**

```
CPU性能：
单核跑分 > 1000：优秀
单核跑分 500-1000：良好
单核跑分 < 500：较弱

硬盘I/O：
> 500MB/s：SSD，优秀
100-500MB/s：SSD，良好
< 100MB/s：HDD，不推荐

网络速度（中国测试节点）：
> 50MB/s：优秀
20-50MB/s：良好
10-20MB/s：一般
< 10MB/s：较差
```

## 10.4 付款方式与隐私保护

### 10.4.1 付款方式对比

**支付宝/微信支付：**

```
优势：
✓ 方便快捷
✓ 国人友好
✓ 无需信用卡
✓ 汇率透明

劣势：
✗ 实名认证
✗ 可追溯
✗ 部分商家不支持

隐私等级：⭐⭐

支持商家：
- Vultr ✓
- Hostwinds ✓
- 搬瓦工 ✓
- DigitalOcean ✗
- Linode ✗
```

**信用卡：**

```
优势：
✓ 广泛接受
✓ 自动续费
✓ 有消费保护

劣势：
✗ 需要验证
✗ 可能被盗刷
✗ 有额度限制

隐私等级：⭐⭐

注意事项：
⚠️ 使用虚拟信用卡
⚠️ 设置消费提醒
⚠️ 定期检查账单
```

**PayPal：**

```
优势：
✓ 国际通用
✓ 买家保护
✓ 相对安全

劣势：
✗ 需绑定银行卡/信用卡
✗ 可能冻结账户
✗ 有手续费

隐私等级：⭐⭐⭐

支持商家：
- 几乎所有国际商家
```

**加密货币：**

```
优势：
✓ 匿名性强
✓ 不可追溯
✓ 去中心化

劣势：
✗ 操作复杂
✗ 汇率波动
✗ 支持商家少
✗ 不可退款

隐私等级：⭐⭐⭐⭐⭐

支持商家：
- 部分小众VPS商家
- 需要寻找
```

### 10.4.2 隐私保护建议

**注册信息：**

```
建议做法：
✓ 使用临时邮箱（注册后绑定常用邮箱）
✓ 不填写真实姓名（如允许）
✓ 地址使用生成器
✓ 使用VPN/代理注册

临时邮箱推荐：
- https://temp-mail.org
- https://10minutemail.com
- https://guerrillamail.com

地址生成器：
- https://www.fakeaddressgenerator.com
```

**付款隐私：**

```
降低追溯性：
1. 使用虚拟信用卡
   - Privacy.com（美国）
   - Revolut（欧洲）
   
2. 使用礼品卡
   - Amazon礼品卡
   - Google Play礼品卡（部分商家）
   
3. 使用加密货币
   - Bitcoin（追溯性较强）
   - Monero（隐私性强）

注意：
⚠️ 不要过度追求匿名
⚠️ 平衡隐私与便利性
⚠️ 遵守当地法律
```

### 10.4.3 账号安全

**密码安全：**

```
强密码原则：
✓ 至少16位
✓ 包含大小写字母、数字、符号
✓ 不使用个人信息
✓ 每个服务使用不同密码

密码管理器推荐：
- Bitwarden（开源、免费）
- 1Password（功能强大）
- KeePass（本地存储）

示例强密码：
Kx9#mP2$vL4@nQ8!wR5
```

**两步验证（2FA）：**

```
启用2FA：
1. VPS后台 → Security Settings
2. Enable Two-Factor Authentication
3. 使用认证器应用扫描二维码
4. 保存备用码

认证器应用推荐：
- Google Authenticator
- Microsoft Authenticator
- Authy（支持多设备同步）

重要：
⚠️ 备份恢复码
⚠️ 多设备备份
⚠️ 不要截图保存
```

## 10.5 IP质量检测

### 10.5.1 IP类型识别

**住宅IP vs 数据中心IP：**

```
住宅IP（Residential IP）：
- 来自ISP分配给家庭用户
- 信誉度高
- 不易被封
- 价格昂贵
- VPS很少提供

数据中心IP（Datacenter IP）：
- 来自数据中心
- 信誉度一般
- 容易被识别
- 价格便宜
- VPS常用

检测工具：
https://ipinfo.io/your-ip
查看 "org" 字段，如果是ISP名称 = 住宅IP
```

### 10.5.2 IP黑名单检测

**检测IP是否被列入黑名单：**

```
在线检测工具：

1. MXToolbox
   https://mxtoolbox.com/blacklists.aspx
   
2. MultiRBL
   http://multirbl.valli.org/
   
3. WhatIsMyIPAddress
   https://whatismyipaddress.com/blacklist-check

检测内容：
- Spamhaus
- Barracuda
- SORBS
- 等100+黑名单数据库

判断：
✓ Clean：干净，可用
⚠️ Listed：被列入黑名单，可能影响邮件等服务
```

### 10.5.3 流媒体解锁检测

**Netflix解锁检测：**

```bash
# 使用脚本检测
bash <(curl -L -s check.unlock.media)

# 或
wget -O nf https://github.com/sjlleo/netflix-verify/releases/download/v3.1.0/nf_linux_amd64 && chmod +x nf && ./nf

# 结果解读：
✓ 原生IP：完全解锁Netflix
⚠️ 非原生IP：可能无法观看
✗ 不支持：无法使用Netflix

# 手动测试
curl -I https://www.netflix.com
# 查看返回的地区信息
```

**其他流媒体：**

```bash
# Disney+ 检测
curl -I https://www.disneyplus.com

# YouTube Premium检测
# 登录后查看是否能使用Premium功能

# HBO Max检测
curl -I https://play.hbomax.com
```

### 10.5.4 端口封锁检测

**常用端口检测：**

```bash
# 在VPS上运行（需先安装nc）
apt install netcat -y

# 监听测试端口
nc -l 1234

# 在本地测试连通性
telnet your-vps-ip 1234
# 或
nc -zv your-vps-ip 1234

# 常见被封端口：
25    - SMTP（几乎都被封）
465   - SMTPS
587   - 邮件提交
1194  - OpenVPN
1723  - PPTP VPN
```

**在线端口检测：**

```
工具：
https://www.yougetsignal.com/tools/open-ports/
https://canyouseeme.org/

测试常用代理端口：
443  - HTTPS（推荐）
80   - HTTP
8080 - 备用HTTP
1080 - SOCKS
```

### 10.5.5 IP质量综合评分

**IP质量评估清单：**

```
✓ Ping延迟
  < 100ms：优秀
  100-200ms：良好
  > 200ms：一般

✓ 丢包率
  0%：完美
  < 1%：优秀
  1-5%：可接受
  > 5%：较差

✓ 路由跳数
  < 15跳：优秀
  15-25跳：一般
  > 25跳：绕路严重

✓ IP类型
  住宅IP：⭐⭐⭐⭐⭐
  数据中心IP：⭐⭐⭐

✓ 黑名单状态
  Clean：⭐⭐⭐⭐⭐
  Listed：⭐⭐

✓ 流媒体解锁
  Netflix原生：⭐⭐⭐⭐⭐
  部分解锁：⭐⭐⭐
  不解锁：⭐

✓ 端口开放
  全部开放：⭐⭐⭐⭐⭐
  部分限制：⭐⭐⭐
```

**综合测试脚本：**

```bash
# 融合怪测试（推荐）
bash <(curl -L -s https://raw.githubusercontent.com/spiritLHLS/ecs/main/ecs.sh)

# 测试项目：
- 系统信息
- CPU性能
- 内存测试
- 硬盘速度
- 网络测速
- 流媒体解锁
- IP质量检测
- 路由跟踪

# 等待测试完成（约5-10分钟）
# 获得详细的VPS性能报告
```

---

## 本章小结

本章详细介绍了VPS选购的各个方面：

**核心要点：**

1. **供应商选择**：
    - Vultr：新手友好、支付方便
    - DigitalOcean/Linode：性能稳定
    - 搬瓦工：中国优化、CN2线路
    - Hostwinds：性价比高、不限流量

2. **地域选择**：
    - 游戏：香港、日本（低延迟）
    - 日常：日本、新加坡、美西
    - 流媒体：美国原生IP
    - 特定服务：按需选择

3. **配置需求**：
    - 个人使用：1GB内存，500GB-1TB流量
    - 重度使用：2GB内存，2TB流量
    - 多人共享：按人数倍增

4. **付款隐私**：
    - 支付宝/微信：方便但可追溯
    - 信用卡：广泛接受
    - PayPal：国际通用
    - 加密货币：匿名性强

5. **IP质量**：
    - 延迟测试
    - 黑名单检测
    - 流媒体解锁
    - 端口开放情况

**选购建议：**

```
新手推荐方案：
供应商：Vultr
机房：东京/洛杉矶/新加坡
配置：$6/月（1GB内存、1TB流量）
付款：支付宝
理由：简单、便宜、够用

进阶方案：
供应商：搬瓦工
机房：洛杉矶 CN2 GIA
配置：$50/年起
付款：支付宝
理由：速度快、稳定、针对中国优化

预算充足：
供应商：Linode / DigitalOcean
机房：按需选择
配置：$10-20/月
付款：信用卡/PayPal
理由：性能好、稳定性高、服务优质
```

下一章我们将学习服务器环境配置。

---

**实践任务：**

1. 注册VPS供应商账号
2. 测试不同机房延迟
3. 购买并开通VPS
4. 进行IP质量检测
5. 记录服务器信息